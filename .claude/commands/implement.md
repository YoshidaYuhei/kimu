---
description: ADRとテストコードを読んで実装を行う
---

ADR（Architecture Decision Record）とテストコードを読み、設計決定に基づいた実装を行います。以下の手順に従ってください：

1. **ADRファイルの特定と読み込み**:
   - コマンド引数としてADR番号またはファイルパスが渡された場合は、それを使用
   - 渡されていない場合は、`docs/adr/`ディレクトリ内のADRファイル一覧を表示し、ユーザーに選択させる
   - ADRファイルを読み込み、以下を理解する：
     - 決定内容：何を実装するのか
     - アーキテクチャアプローチ：どのように実装するか
     - 技術選択：使用する技術やライブラリ
     - 制約・トレードオフ：実装時に考慮すべき制約
     - 影響範囲：実装対象のコンポーネントや範囲

2. **関連テストコードの検索と読み込み**:
   - ADRに関連するテストファイルを検索（ADR番号へのコメント参照、ファイル名パターン等）
   - 見つかったテストファイルを読み込み、以下を理解する：
     - テストされる振る舞い（正常系・異常系）
     - 期待される入出力
     - エッジケース
     - インターフェース仕様
   - テストファイルが見つからない場合は、ユーザーにテストファイルパスを尋ねるか、テストなしで実装を進めるか確認

3. **実装方針の確認**:
   AskUserQuestionツールを使用して、以下を確認：

   - **実装対象**: どのファイル/コンポーネント/関数を実装するか
   - **実装スコープ**: 全体実装か、段階的実装か
   - **既存コードの扱い**: 新規作成か、既存コードの修正か
   - **追加の要件**: ADRやテストに記載されていない追加要件はあるか

4. **実装の実行**:
   収集した情報を元に、実装を行う：

   **TypeScript/React実装のベストプラクティス**:
   - 型安全性：適切な型定義を使用
   - コンポーネント設計：関心の分離、単一責任の原則
   - フック使用：適切なReact Hooksの活用
   - パフォーマンス：useMemo、useCallbackの適切な使用
   - アクセシビリティ：ARIA属性の適切な使用

   **実装時の注意点**:
   - ADRの決定内容に忠実に従う
   - テストが通るように実装（TDD的アプローチ）
   - 既存のコードスタイルに合わせる
   - 適切なエラーハンドリング
   - コメント：複雑なロジックには説明を追加、ADRへの参照を含める

5. **テストの実行と検証**:
   - 実装完了後、関連するテストを実行
   - Jestテスト: `npm test -- [テストファイルパス]`
   - テストが失敗した場合は、エラーを分析して修正
   - すべてのテストが通るまで実装を調整

6. **型チェックとリント**:
   - TypeScript型チェック: `npx tsc --noEmit`
   - ESLint: `npm run lint` または `npx eslint [ファイルパス]`
   - エラーや警告があれば修正

7. **実装完了の報告**:
   - 実装したファイルのパスを表示
   - テスト結果を表示
   - ADRの決定内容がどのように実装されたかを簡潔に説明
   - 次のステップ（E2Eテストの実行、コードレビュー等）を提案

8. **エッジケースへの対応**:
   - 必要なディレクトリが存在しない場合は作成
   - 必要な依存パッケージが不足している場合は通知
   - ADRやテストに矛盾がある場合は、ユーザーに確認
   - 実装中に設計上の問題が見つかった場合は、ユーザーに報告

プロセス全体を通して、ADRの設計決定とテスト仕様に基づいた高品質な実装を心がけ、テスト駆動開発（TDD）の原則に従ってください。
