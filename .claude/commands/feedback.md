---
description: 会話履歴を分析してClaude指示の改善案を提案する
---

会話履歴を分析し、カスタムスラッシュコマンドやCLAUDE.mdの改善案を提案します。以下の手順に従ってください：

1. **会話履歴の分析**:
   - 現在の会話セッションを振り返る
   - 以下の観点で分析：
     - ユーザーが頻繁に要求するタスクパターン
     - Claude が迷った・質問が必要だった箇所
     - 既存コマンドで対応できなかったケース
     - コマンド実行時に不足していた情報
     - ユーザーとのやり取りで改善できる点
     - 繰り返し説明が必要だった概念やルール

2. **既存リソースの確認**:
   - `.claude/commands/` ディレクトリ内のすべてのカスタムコマンドを読み込む
   - `CLAUDE.md` の内容を読み込む
   - 各コマンドの目的、フロー、不足点を理解

3. **改善領域の特定**:
   以下の観点で改善が必要な領域を特定：

   **カスタムコマンドの改善**:
   - 不明確な指示や曖昧な表現
   - 不足している手順やエッジケース処理
   - より効率的なフロー
   - 追加すべきバリデーションやエラーハンドリング
   - ユーザー体験の向上（質問の仕方、フィードバック等）
   - コマンド間の連携強化

   **CLAUDE.mdの改善**:
   - 不足しているプロジェクト情報
   - コーディング規約やベストプラクティス
   - プロジェクト固有のルールや制約
   - よくある落とし穴や注意点
   - ディレクトリ構造やアーキテクチャの説明
   - 開発ワークフローの明確化

   **新規コマンドの提案**:
   - 会話で繰り返し出てきたタスクパターン
   - 既存コマンドの組み合わせで実現できそうな高レベルタスク
   - プロジェクト特有のニーズに対応するコマンド

4. **改善案の優先順位付け**:
   改善案を以下の基準で優先順位付け：
   - **Impact（影響度）**: その改善がどれだけ効果的か
   - **Frequency（頻度）**: その問題がどれだけ頻繁に発生するか
   - **Effort（労力）**: 改善にどれだけの労力が必要か

   優先度を「高」「中」「低」で分類

5. **改善案の作成**:
   各改善案について、以下を含む詳細な提案を作成：

   ```markdown
   ## 改善案 [番号]: [タイトル]

   ### 優先度
   高 / 中 / 低

   ### 対象
   - [ ] カスタムコマンド: [コマンド名]
   - [ ] CLAUDE.md
   - [ ] 新規コマンド提案

   ### 現状の問題
   [何が問題か、なぜ改善が必要か]

   ### 改善提案
   [具体的にどう改善するか]

   ### 期待される効果
   [この改善によってどんな利点があるか]

   ### 実装方法
   [具体的な実装手順や、追加すべき内容の例]
   ```

6. **フィードバックレポートの生成**:
   すべての改善案をまとめたレポートを作成：

   ```markdown
   # Claude指示改善フィードバックレポート

   生成日時: [日時]

   ## エグゼクティブサマリー
   [会話の概要と主要な改善ポイント]

   ## 分析結果
   - 会話のターン数: [数]
   - 使用されたコマンド: [リスト]
   - 特定された改善領域: [数]

   ## 高優先度の改善案
   [優先度「高」の改善案リスト]

   ## 中優先度の改善案
   [優先度「中」の改善案リスト]

   ## 低優先度の改善案
   [優先度「低」の改善案リスト]

   ## 新規コマンド提案
   [新しいコマンドのアイデア]

   ## アクションアイテム
   1. [最初に実施すべき改善]
   2. [次に実施すべき改善]
   ...

   ## 補足
   [その他の気づきや提案]
   ```

7. **ユーザーへの確認**:
   AskUserQuestionツールを使用して、以下を確認：

   - **改善の適用**: どの改善案を実際に適用するか
   - **適用範囲**: すべての高優先度改善を一度に適用するか、個別に選択するか
   - **フィードバックの保存**: レポートをファイルとして保存するか

8. **改善の適用**:
   ユーザーが選択した改善案を実際に適用：
   - カスタムコマンドファイルの更新
   - CLAUDE.mdの更新
   - 新規コマンドの作成

9. **変更のサマリー**:
   適用した変更を要約して表示：
   - 更新されたファイルのリスト
   - 各変更の内容
   - 次回の会話で期待される改善点

プロセス全体を通して、具体的で実行可能な改善案を提供することを心がけ、単なる批判ではなく建設的な提案を行ってください。会話の文脈を深く理解し、プロジェクト固有のニーズに合わせた改善を提案してください。
